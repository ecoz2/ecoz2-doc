\documentclass{beamer}

%\usepackage{verbatim}
\usepackage{anyfontsize}
\usepackage{tikz}
\usepackage{media9}
\usepackage{graphicx}

\usetheme{Boadilla}

\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}

\newcommand{\ba}{\ensuremath{\mathbf{a}}}
\newcommand{\bb}{\ensuremath{\mathbf{b}}}
\newcommand{\bx}{\ensuremath{\mathbf{x}}}
\newcommand{\bo}{\ensuremath{\mathbf{o}}}
\newcommand{\bC}{\ensuremath{\mathbf{C}}}
\newcommand{\bq}{\ensuremath{\mathbf{q}}}


\title{
    Whale Song Unit Classification
}
\subtitle{
    Some Preliminary Exploration\\
    Using Linear Prediction Vector Quantization\\
    and Hidden Markov Modeling
}
\author{Carlos Rueda}

\begin{document}

\frame {
    \titlepage
}

\frame {
    \frametitle{The Problem}

    Following Mitchell (1997), we state the problem as follows:

    \begin{itemize}
        \setlength\itemsep{1em}
        \item \alert{Task}: \\
            Classify whale song unit instances\\
            according to a given vocabulary of whale song unit types

        \item \alert{Performance measure}:\\
            Percent of instances correctly classified

        \item \alert{Training experience}:\\
            A database of labelled whale song unit instances
    \end{itemize}
}

\begin{frame}[fragile]
    \frametitle{Whale Song Units}

    \centering
    \includegraphics[width=0.7\textwidth]{from_HBSe_20151207T070326__124_45328_126_52461.png}
    \includemedia[
        height=0.44em,
        addresource=from_HBSe_20151207T070326__124.45328_126.52461.mp3,
        flashvars={
            source=from_HBSe_20151207T070326__124.45328_126.52461.mp3
            &autoPlay=true
        }
    ]{\fbox{Play}}{APlayer.swf}

    {\tiny A ``modulated cry'' instance, from \verb|HBSe_20151207T070326.wav, 124.5sec-126.5sec|}

    \begin{itemize}
        \setlength\itemsep{1em}
        \item
            Acoustic signal:
            \begin{equation*}
            \bx = \langle x_1, x_2, \ldots, x_N \rangle \qquad (N=66,283)
            \end{equation*}


    \end{itemize}
\end{frame}

\frame{
\frametitle{Linear Predictive Coding}

\begin{itemize}
    \setlength\itemsep{1em}
    \item
    Acoustic signal:
    \begin{equation*}
        \bx = \langle x_1, x_2, \ldots, x_N \rangle
    \end{equation*}

    \item
    Transformed into a sequence of \alert{predictor} vectors:
    \begin{equation*}
        \ba = \langle \ba_1, \ba_2, \ldots, \ba_T \rangle
    \end{equation*}

    \item
    Transformed into a \alert{sequence of symbols}:
    \begin{equation*}
        \bo = \langle o_1, o_2, \ldots, o_T \rangle
    \end{equation*}
    where $o_t \in \{ 1, 2, \ldots, M \}$

\end{itemize}

}

\frame{
\frametitle{Linear Predictive Coding}

\input{lpc-vq.tex}

}

\frame{
\frametitle{Linear Prediction}

\input{lp.tex}

\begin{itemize}
    \item
        Estimate $x(n)$ as a linear combination of $P$ previous samples:
        \begin{equation*}
            \hat{x}(n) = - \sum\limits_{i=1}^{P} \alert{a(i)} x(n-i)
        \end{equation*}

\end{itemize}

}

\frame{
\frametitle{Linear Prediction}

\begin{itemize}
    \setlength\itemsep{1em}
    \item Error:
    \begin{equation*}
        \begin{array}{rclc}
            e(n) &=& x(n) - \hat{x}(n)\\
            &=& \sum\limits_{i=0}^{P} \alert{a(i)} x(n-i)
        \end{array}
    \end{equation*}

    \item Find prediction coefficients by minimizing the
        sum of the squared error over the signal interval:
    \begin{equation*}
        \begin{array}{rcl}
            E &=& \sum\limits_n e^2(n)\\
              &=& \sum\limits_n \left( \sum\limits_{i=0}^{P} \alert{a(i)} x(n-i) \right)^2
        \end{array}
    \end{equation*}

\end{itemize}
}

\frame{
\frametitle{Vector Quantization}

\centering
\includegraphics[width=0.3\textwidth]{voronoi.png}
\qquad\qquad
\includegraphics[width=0.35\textwidth]{Juang-cell_shape.png}

\begin{itemize}
    \item Partition the $P$-dimensional space into $M$ regions
         that "best" represent the predictor vectors
         arising from song units instances

    \item "Best" in terms of minimizing some overall distortion measure

    \item Let $\bC \equiv \langle C_1,C_2,\ldots,C_M \rangle$ be
        the set of centroids that best represent the space

\end{itemize}

}

\frame{
\frametitle{Vector Quantization}

\begin{itemize}
    \item \alert{Quantization}:\\
        With \bC, we can map each $\ba^{(t)}$ to a symbol $o_t$:
        \begin{equation*}
         o_t \gets \argmin\limits_{k=1}^{M} d(\ba^{(t)}, C_k)
        \end{equation*}

\end{itemize}

}

\frame{
\frametitle{Hidden Markov Model}

\begin{itemize}
    \item $\pi$, initial state probability distribution:
        \[
            \pi = (\pi_1, \pi_2, \ldots, \pi_N)
        \]

    \item  $A$, state transition distributions:
        \[
            A =
            \begin{bmatrix}
                a_{11} & a_{12} & \dots  & a_{1N} \\
                a_{21} & a_{22} & \dots  & a_{2N} \\
                \vdots & \vdots & \ddots & \vdots \\
                a_{N1} & a_{N2} & \dots  & a_{NN}
            \end{bmatrix}
        \]

    \item $B$, observation symbol distributions:
        \[
            B =
            \begin{bmatrix}
                b_{11} & b_{12} & \dots  & b_{1M} \\
                b_{21} & b_{22} & \dots  & b_{2M} \\
                \vdots & \vdots & \ddots & \vdots \\
                b_{N1} & b_{N2} & \dots  & b_{NM}
            \end{bmatrix}
        \]
\end{itemize}

}


\frame{
\frametitle{Hidden Markov Modeling}

\input{hmm.tex}

\begin{itemize}
    \setlength\itemsep{1em}
    \item $\bq = \langle q_1, q_2, \ldots, q_T \rangle$:
        hidden state sequence

    \item $\bo = \langle o_1, o_2, \ldots, o_T \rangle$:
        our acoustic signal
\end{itemize}

}

\frame{
\frametitle{HMM Operations}

With $\lambda = (\pi, A, B)$ denoting an HMM

\begin{itemize}
    \setlength\itemsep{1em}

	\item For given $\bo$ and $\lambda$,
        compute $P[\bo|\lambda]$

    \item For given $\bo$ and $\lambda$,
        estimate a most likely state sequence $\bq^*$

	\item Learn a model $\lambda^* \equiv (\pi^*, A^*, B^*)$\\
        such that $P[\bo|\lambda^*]$ is maximized for a given
		observation sequence $\bo$

\end{itemize}

}

\input{statsml.tex}


\end{document}
